import{a as p}from"./chunk-MV2P2U5R.js";import{Ca as a,k as n,p as h,r}from"./chunk-EYTT7SII.js";var f=(()=>{let t=class t{constructor(i,e){this.http=i,this.configservice=e,this.isStoppedSpeechRecog=!1,this.text="",this.voiceToTextSubject=new n,this.speakingPaused=new n,this.tempWords="",this._configservice=e}speechInput(){return this.voiceToTextSubject.asObservable()}init(i="en-US"){return this.recognition=new webkitSpeechRecognition,this.recognition.interimResults=!0,this.recognition.lang=i,this.recognition.addEventListener("result",e=>{let c=Array.from(e.results).map(o=>o[0]).map(o=>o.transcript).join("");this.tempWords=c,this.voiceToTextSubject.next(this.text||c)}),this.initListeners()}initListeners(){return this.recognition.addEventListener("end",i=>{this.recognition.stop()}),this.speakingPaused.asObservable()}start(){this.text="",this.isStoppedSpeechRecog=!1,this.recognition.start(),this.recognition.addEventListener("end",i=>{this.isStoppedSpeechRecog?(this.recognition.isActive=!0,this.recognition.stop()):(this.isStoppedSpeechRecog=!1,this.wordConcat(),(!this.recognition.lastActiveTime||Date.now()-this.recognition.lastActive>200)&&(this.recognition.start(),this.recognition.lastActive=Date.now())),this.voiceToTextSubject.next(this.text)})}stop(){this.text="",this.isStoppedSpeechRecog=!0,this.wordConcat(),this.recognition.stop(),this.recognition.isActive=!1,this.speakingPaused.next("Stopped speaking")}wordConcat(){this.text=this.text.trim()+" "+this.tempWords,this.text=this.text.trim(),this.tempWords=""}};t.\u0275fac=function(e){return new(e||t)(r(p),r(a))},t.\u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();export{f as a};
