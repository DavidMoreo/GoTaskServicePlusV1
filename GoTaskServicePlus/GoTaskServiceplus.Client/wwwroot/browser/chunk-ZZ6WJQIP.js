import{d as K,f as Q}from"./chunk-FWKZQHCM.js";import{a as Y}from"./chunk-5BMLOIMT.js";import"./chunk-ISTIWSIF.js";import"./chunk-LQ45HHEO.js";import"./chunk-Q2UCRY37.js";import"./chunk-MVUZ45C4.js";import"./chunk-ROSI6QSI.js";import"./chunk-OMG2A7U2.js";import"./chunk-VLMSGL5J.js";import{a as T,b as X}from"./chunk-DY7UBFIR.js";import"./chunk-MV2P2U5R.js";import{$ as D,A as c,B as p,Ca as G,E as y,H as f,I as g,J as A,K as S,L as P,M as l,N as a,O as m,P as H,Q as I,R as _,U as O,Va as q,W as N,X as s,Y as x,aa as C,i as h,ia as R,ka as V,la as F,oa as $,p as k,r as B,s as j,ta as z,u as b,v as w,va as U,x as M,xa as J}from"./chunk-EYTT7SII.js";var W=(()=>{let o=class o{constructor(t,e,n){this.http=t,this.host=e,this._listBuyGroupByIdBuy=new Array,this.isBuyProduct=!1,this.limitHttp=10,this.counHttp=0,this._host=e,this._http=t,this._loading=n}GetAllProduct(t){return h(this,null,function*(){let e=new F({"Content-Type":"application/json"});this.ReloadHttp(),yield this.GetAllCartStorage(),this._listBuyGroupByIdBuy=new Array;var n=this._http.post(this._host.GetHostApi()+`BuyCustomer/GetAllBuyCustomer?page=${t}`,this._listBuyStorageTemp,{headers:e});return n.subscribe({next:d=>{this._loading.Loading(!1),d.status&&(this._listProduct=d.data,this._listProduct.forEach(u=>{var v=this._listBuyGroupByIdBuy.find(E=>E==u.id);(v==null||v==null)&&this._listBuyGroupByIdBuy.push(u.idBuy)}))},error:d=>{this._loading.Loading(!1)}}),n})}CancelBuy(t){let e=new F({"Content-Type":"application/json"});var n=this._http.post(this._host.GetHostApi()+`BuyCustomer/CancelBuyById?id=${t}&movementTypeItem=Compra cancelada por cliente`,{headers:e});return n.subscribe(d=>{d.status&&(console.log(d.status),this._listProduct=this._listProduct.filter(u=>u.id!=t),this.LoadGroup(),this._loading.Loading(!1),this.RemoveBuyById(t))}),n}LoadGroup(){this._listBuyGroupByIdBuy=new Array,this._listProduct.forEach(t=>{var e=this._listBuyGroupByIdBuy.find(n=>n==t.idBuy);(e==null||e==null)&&this._listBuyGroupByIdBuy.push(t.idBuy)})}ClearCacheBuy(){this.GetAllCartStorage(),this._listBuyStorageTemp!=null&&this._listBuyStorageTemp!=null&&this._listBuyStorageTemp.forEach(t=>{var e=this._listBuyGroupByIdBuy.find(n=>n==t);(e==null||e==null)&&this.RemoveBuyById(t)})}GetAllCartStorage(){var t=window.localStorage.getItem("BuyList");t!=null&&t!=null&&t!=""&&(this._listBuyStorageTemp=JSON.parse(t)),this._listBuyStorageTemp==null&&(this._listBuyStorageTemp=new Array)}RemoveBuyById(t){this.GetAllCartStorage(),this._listBuyStorageTemp=this._listBuyStorageTemp.filter(e=>e!=t),window.localStorage.setItem("BuyList",JSON.stringify(this._listBuyStorageTemp))}GetListNull(){return this.counHttp++,(this._listProduct==null||this._listProduct==null)&&this.counHttp<this.limitHttp&&this._listBuyStorageTemp!=null&&this._listBuyStorageTemp.length>0}BuyProduct(t){this.isBuyProduct=!0}ReloadHttp(){return h(this,null,function*(){if(this.counHttp++,console.log("ReloadHttp",this._listProduct),this.counHttp<=this.limitHttp&&this.GetListNull())var t=setInterval(()=>{clearInterval(t),this.GetListNull()&&this.GetAllProduct(0)},1e4)})}};o.\u0275fac=function(e){return new(e||o)(B($),B(G),B(T))},o.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();var nt=(i,o)=>o.id,ot=(i,o)=>o.value;function rt(i,o){if(i&1&&(l(0,"p"),s(1),a()),i&2){let r=o.$implicit;c(1),x(r.value)}}function at(i,o){if(i&1&&(l(0,"div",22)(1,"b"),s(2,"Ciudad"),a(),S(3,rt,2,1,"p",null,ot),l(5,"b"),s(6,"Ubicacion en Google"),a(),l(7,"a",23)(8,"button",24),m(9,"i",25),a()(),l(10,"b"),s(11,"Nombre de la tienda"),a(),l(12,"p"),s(13),a()()),i&2){let r=_().$implicit;c(3),P(r.city),c(4),O("href",r.gps,M),c(6),x(r.conceptCompany.name)}}var L=i=>({gray:i});function st(i,o){if(i&1){let r=H();l(0,"div",7)(1,"div",8)(2,"div",9),m(3,"img",10),a(),l(4,"p"),s(5),a()(),l(6,"div",11,12)(8,"div",13)(9,"button",14),s(10,"1"),a(),s(11," Compra en validaci\xF3n "),a(),l(12,"div",13)(13,"button",14),s(14,"2"),a(),s(15," Compra en alistamiento "),a(),l(16,"div",13)(17,"button",14),s(18,"3"),a(),s(19," Ya puedes reclamar tu compra "),a(),f(20,at,14,2,"div",15),l(21,"div",13)(22,"button",14),s(23,"4"),a(),s(24," Compra en entregada "),a()(),l(25,"div",16)(26,"button",17),I("click",function(){b(r);let e=_(4);return w(e.loadData())}),s(27,"Recargar "),m(28,"i",18),a(),l(29,"button",19),I("click",function(){let n=b(r).$implicit,d=_(4);return w(d.CancelBuy(n.id))}),s(30,"Cancelar "),m(31,"i",20),a(),l(32,"button",17),I("click",function(){b(r);let e=N(7);return w(e.style.display=="none"?e.style.display="flex":e.style.display="none")}),s(33,"Detalle "),m(34,"i",21),a()()()}if(i&2){let r=o.$implicit,t=_(4);c(3),O("src",t.GetUrlImg(r,"PHONE"),M),c(2),x(r.name),c(3),y("ngClass",C(7,L,r.movementTypeItem!=t._movementType.purchaseGenerated)),c(4),y("ngClass",C(9,L,r.movementTypeItem!=t._movementType.purchaseInProcess)),c(4),y("ngClass",C(11,L,r.movementTypeItem!=t._movementType.purchaseInDelivery)),c(4),g(20,r.movementTypeItem==t._movementType.purchaseInDelivery?20:-1),c(1),y("ngClass",C(13,L,r.movementTypeItem!="Compra entregada"))}}function lt(i,o){if(i&1&&(S(0,st,35,15,"div",26,nt),l(2,"p",6),s(3),a()),i&2){let r=o.$implicit,t=_(3);P(t.GetGroup(t._ListBuyService._listProduct,r)),c(3),x(t.GetGroupPrice(t._ListBuyService._listProduct,r))}}function ct(i,o){if(i&1&&S(0,lt,4,1,"p",27,A),i&2){let r=_(2);P(r._ListBuyService._listBuyGroupByIdBuy)}}function dt(i,o){if(i&1&&f(0,ct,2,0),i&2){let r=_();g(0,r.GetExistPurcchare()?-1:0)}}function ut(i,o){i&1&&(l(0,"p",28),s(1,"No tienes compras realizadas"),a())}var Pt=(()=>{let o=class o{constructor(t,e,n,d,u,v,E){this.route=t,this.type="all",this.page=0,this._listGuid=new Array,this._movementType=new K,this._param=n,this._titleService=e,this._ListBuyService=d,this._loading=u,this._BuyProduct=v,this._configservice=E}ngOnInit(){this._titleService.setTitle("Mi carrito de compras"),this.loadData()}loadData(){return h(this,null,function*(){this._loading.Loading(!0),this._ListBuyService.GetAllProduct(0)})}GetUrlImg(t,e){var n=this._configservice.GetUrlImgBuy(t,e);return n}GetCity(t){var e=Array();return t.forEach(n=>{e.push(n.value)}),e}CancelBuy(t){this._ListBuyService.CancelBuy(t)}GetGroup(t,e){return t.filter(n=>n.idBuy==e)}GetGroupPrice(t,e){var n=t.filter(u=>u.idBuy==e),d=0;return n.forEach(u=>{d+=u.salePrice*u.quantity}),this.converCurrency(d)}converCurrency(t){var n=Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(t);return n}GetExistPurcchare(){return this._ListBuyService!=null&&(this._ListBuyService._listProduct==null||this._ListBuyService._listProduct==null||this._ListBuyService._listProduct.length<=0)}};o.\u0275fac=function(e){return new(e||o)(p(J),p(z),p(U),p(W),p(T),p(Q),p(G))},o.\u0275cmp=j({type:o,selectors:[["app-customer-list-buy"]],standalone:!0,features:[D],decls:8,vars:3,consts:[[1,"scroll"],[1,"container-prices-general"],[1,"product-container"],[1,"margin"],["class","title-msg"],[3,"active"],[1,"total"],[1,"item-buy"],[1,"header-item"],[1,"item-ico"],[1,"img-ico",3,"src"],[1,"detail-status",2,"display","none"],["detail",""],[1,"status",3,"ngClass"],[1,"status-btn"],["class","datail-purchase"],[1,"btn-menu"],[1,"btn-item-menu","ok",3,"click"],[1,"bi","bi-arrow-clockwise"],[1,"btn-item-menu","cancel",3,"click"],[1,"bi","bi-x-circle"],[1,"bi","bi-caret-down-fill"],[1,"datail-purchase"],["target","_blank",3,"href"],[1,"gps"],[1,"bi","bi-geo-alt-fill"],["class","item-buy"],["class","total"],[1,"title-msg"]],template:function(e,n){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2),f(3,dt,1,1),a()(),m(4,"div",3),a(),f(5,ut,2,0,"p",4),m(6,"app-menu-phone")(7,"app-common-loading",5)),e&2&&(c(3),g(3,n._ListBuyService.GetListNull()?-1:3),c(2),g(5,n.GetExistPurcchare()?5:-1),c(2),y("active",n._ListBuyService.GetListNull()))},dependencies:[X,q,V,R,Y],styles:[".item-buy[_ngcontent-%COMP%]{width:500px;background-color:#6db774;border-radius:5px;justify-content:start;padding:5px;box-shadow:0 0 5px #000;font-size:12px;color:#fff;display:flex;justify-content:space-between;align-items:center;flex-direction:column}@media (max-width: 480px){.item-buy[_ngcontent-%COMP%]{width:95vw}}.product-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:5px;overflow:auto;align-items:center;row-gap:20px}.delete[_ngcontent-%COMP%]{height:100%;width:50px;border-radius:5px;background-color:#ff7f7f;color:#fff}i[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px black)}.title[_ngcontent-%COMP%]{background-color:green;color:#fff;text-align:center;padding:5px;width:100%;margin-top:100px}.item-ico[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.img-ico[_ngcontent-%COMP%]{height:35px;width:auto;min-width:45px;border-radius:5px;box-shadow:0 0 5px #000}.header-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;background-color:#00f;border-radius:5px;box-shadow:0 0 5px #000}.header-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;font-size:10px;width:90%}.btn-menu[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:center;column-gap:10px;margin-top:10px;width:100%}.btn-item-menu[_ngcontent-%COMP%]{width:100px;border:none;box-shadow:0 0 5px #000,0 0 5px #000 inset;border-radius:0 0 5px 5px;color:#fff}.detail-status[_ngcontent-%COMP%]{width:95%;border:1px solid gray;border-radius:5px;margin-top:10px;margin-bottom:10px;justify-content:start;align-items:start;padding:5px;flex-direction:column;row-gap:10px;display:none}.status[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;column-gap:10px}.status-btn[_ngcontent-%COMP%]{border-radius:100%;width:20px;height:20px;border:none;box-shadow:0 0 5px #000;background-color:green;border:1px solid white;color:#fff}.gray[_ngcontent-%COMP%]{filter:grayscale(100%)}.total[_ngcontent-%COMP%]{background-color:green;width:100%;font-size:20px;text-align:end;color:#fff;padding:3px 80PX 3px 3px;box-shadow:0 0 5px #000}.margin[_ngcontent-%COMP%]{height:200px}.datail-purchase[_ngcontent-%COMP%]{background-color:#0000000d;border-radius:5px;padding:8px;box-shadow:0 0 5px #000 inset;width:90%;display:flex;flex-direction:column;row-gap:10px;border:1px solid gray}.datail-purchase[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:14px;color:#cbcbcb;text-shadow:3px 0px 4px #353535}.datail-purchase[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;color:#000;color:#0e0e0e}.gps[_ngcontent-%COMP%]{border-radius:5px;box-shadow:0 0 5px #000,0 0 5px #000 inset;border:none;height:40px;width:40px}"]});let i=o;return i})();export{Pt as ListBuyComponet};
