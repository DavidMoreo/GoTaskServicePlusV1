import{a as Y}from"./chunk-VNTGGUTZ.js";import{a as $,b as L,c as M,d as q}from"./chunk-IFDYJBL7.js";import{a as V}from"./chunk-OMG2A7U2.js";import"./chunk-VLMSGL5J.js";import"./chunk-DY7UBFIR.js";import{a as N}from"./chunk-MV2P2U5R.js";import{$ as A,A as p,B as h,C as j,Ca as v,E as R,H as C,I as x,K as G,L as F,M as a,N as c,O as w,Oa as D,P as S,Q as g,R as u,Sa as z,Ta as J,Ua as B,Va as H,W as y,X as d,Y as T,_ as O,i as b,p as E,r as k,s as I,ta as U,u as f,v as _}from"./chunk-EYTT7SII.js";var P=class{};var Q=(()=>{let o=class o{constructor(t,e){this.http=t,this._host=e,this._host=this._host}GetListlanguage(t){var e=this.http.getHttp("GetListLanguageSpeech?Language="+t);return e}GetListGroupSpeech(t){var e=this.http.getHttp("GetListGroupSpeech?language="+t);return e}DeleteLanguageSpeech(t,e){var i=this.http.getHttp("DeleteLanguageSpeech?language="+t+"&id="+e);return i}};o.\u0275fac=function(e){return new(e||o)(k(N),k(v))},o.\u0275prov=E({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var ie=(n,o)=>o.id;function ne(n,o){if(n&1){let r=S();a(0,"button",21),g("click",function(){f(r);let e=u(2);return _(e.startRecording())}),w(1,"i",22),c()}}function oe(n,o){if(n&1){let r=S();a(0,"button")(1,"i",23),g("click",function(){f(r);let e=u(2);return _(e.stopRecording())}),c()()}}function re(n,o){if(n&1){let r=S();a(0,"div",15)(1,"div",16)(2,"div",17),d(3," Speaking and listening "),c(),a(4,"div",18),d(5),c(),a(6,"div",19),d(7),c(),a(8,"div",20),C(9,ne,2,0,"button")(10,oe,2,0,"button"),a(11,"button",21),g("click",function(){f(r);let e=u();return _(e.speech(e._item.languageFor))}),d(12,"play"),c()()()()}if(n&2){let r=u();p(5),O(" ",r._item.languageModeFrom,": ",r._item.languageFrom," "),p(2),O(" ",r._item.languageModeFor,": ",r._item.languageFor," "),p(2),x(9,r.isUserSpeaking?-1:9),p(1),x(10,r.isUserSpeaking?10:-1)}}function se(n,o){if(n&1){let r=S();a(0,"button",21),g("click",function(){f(r);let e=u();return _(e.pageGoClear())}),w(1,"i",24),c()}}function ae(n,o){if(n&1&&(a(0,"option",25),d(1),c()),n&2){let r=o.$implicit;R("value",r.name),p(1),T(r.name)}}function ce(n,o){if(n&1){let r=S();a(0,"button",26),g("click",function(){f(r),u();let e=y(11);return _(e.style.display="block")}),w(1,"i",27),c()}}function le(n,o){if(n&1&&(a(0,"div",28)(1,"p"),d(2),c()()),n&2){let r=u();p(2),T(r._textrecognition)}}var Me=(()=>{let o=class o{constructor(t,e,i,s,l,m,W,X){this.fb=m,this._visibleBtn=!0,this._speechStop=!1,this._item=new P,this._counPage=0,this._msg="",this._listVoiceView=new Array,this.statusSpeech=!1,this._listMemory=Array(),this._visibleLoading=!1,this.isUserSpeaking=!1,this._configservice=t,this._cdRef=i,this._titleService=s,this._utiliti=l,this._SpeechRecognition=W,this._SpeechToSpeechService=X,this.searchForm=this.fb.group({searchText:["",D.required]})}ngAfterViewInit(){this.LoadDataAfterView()}ngOnInit(){this.saveLocalStorage("speechPageSpeech","0"),console.log(this._item),this.loadngOnInit(),this.pageGoStart()}loadngOnInit(){this._titleService.setTitle("Aprender ingl\xE9s");var t=new $;t.language="Espa\xF1ol",t.value="en-US",this.getListSpeech();let e=new window.webkitSpeechRecognition;this.initVoiceInput(),this.loadMemory()}LoadDataAfterView(){let t=window.speechSynthesis;t.onvoiceschanged=()=>{this._listVoice=window.speechSynthesis.getVoices(),this._listVoice.forEach(e=>{if(e.localService){let i=new M;i.name=e.name,i.id=this._listVoiceView.length+1,this._listVoiceView.push(i),console.log(e.name)}})}}speech(t){this.stopRecording();let e=window.localStorage.getItem("languageSpeech");if(e!=null&&(e!=""&&this._listVoice.forEach(s=>{e==s.name&&(this._selectedVoice=s)}),console.log(this._listMemory)),this.statusSpeech=!0,t!=""&&t!=null)try{this.statusSpeech=!1,this.texSpeech=t;var i=new SpeechSynthesisUtterance;i.text=this.texSpeech,i.volume=1,i.rate=.6,i.pitch=.7,this._selectedVoice!=null&&(i.voice=this._selectedVoice),i.onend=()=>{this.statusSpeech=!1,this.speechCancel(),console.log("Terminado : "+i)},(i.text=="undefined"||i.text==null)&&(i.text="Lectura finalizada"),speechSynthesis.speak(i),i.onresume=()=>{console.log("onresume :    ")},i.onerror=()=>{console.log("error :  ")},i.onboundary=()=>{console.log("fin :   ")},(speechSynthesis.speaking||speechSynthesis.pending)&&(this.statusSpeech=!0,this._visibleBtn=!1)}catch(s){console.log("Error : "+s),this.alertSmg("No se puede continuar"),this.statusSpeech=!1}this._cdRef.detectChanges()}modeSpeechLang(t){(this._listVoice==null||this._listVoice.length>0)&&this.LoadDataAfterView(),this._listVoiceView=new Array;let e=new M;this._listVoice.forEach(i=>{e=new M,t.target.value=="todos"?(e.name=i.name,e.id=this._listVoiceView.length+1,this._listVoiceView.push(e)):i.localService&&this._listVoiceView.push(e)}),this._cdRef.detectChanges(),this.alertSmg("realizado")}pageGo(t){t=="+"&&this._ItemLanguage.ListLanguageText.length>this._counPage?this._counPage++:t=="-"&&this._counPage>0&&this._counPage--;let e=0;this._ItemLanguage.ListLanguageText.forEach(i=>{e==this._counPage&&(this._item=i),e++}),this._textrecognition="",this._cdRef.detectChanges(),this.saveLocalStorage("speechPageSpeech",this._counPage+""),console.log("List",this._counPage),this._cdRef.detectChanges()}pageGoStart(){var t=this.getMemory("speechPageSpeech");t.then(i=>{this._counPage=parseInt(i)},i=>{this._counPage=0}).catch(i=>{this._counPage=0});let e=0;this._ItemLanguage.ListLanguageText.forEach(i=>{e==this._counPage&&(this._item=i),e++}),this.saveLocalStorage("speechPageSpeech",this._counPage+""),this._cdRef.detectChanges()}pageGoClear(){this._counPage=0,this.saveLocalStorage("speechPageSpeech",this._counPage+""),this.pageGoStart(),this._cdRef.detectChanges()}stopRecording(){this._SpeechRecognition.stop(),this.isUserSpeaking=!1,this._textrecognition="",this._cdRef.detectChanges()}initVoiceInput(){this._SpeechRecognition.init().subscribe(()=>{}),this._SpeechRecognition.speechInput().subscribe(t=>{this._textrecognition=t})}startRecording(){this.isUserSpeaking=!0,this._SpeechRecognition.start(),this._cdRef.detectChanges()}speechCancel(){window.speechSynthesis.cancel(),window.speechSynthesis.speaking&&this.speechCancel(),this.statusSpeech=!1,this._visibleBtn=!0}recognition(){let t=new window.webkitSpeechRecognition;t.lang="es-ES"}onSelectChange(t){this._listVoice.forEach(e=>{e.name==t.target.value&&(this._selectedVoice=e,console.log("saved",JSON.stringify(this._selectedVoice.name)),window.localStorage.setItem("languageSpeech",this._selectedVoice.name))})}inputTextChanged(){this._extractedTextChanged=this._extractedText}getListSpeech(){var t=this.getMemory("speechLanguageName"),e=this.getMemory("speechPageSpeech");let i="";this._counPage=0,t.then(l=>{i=l},l=>{i="Espa\xF1ol_Ingles"}),i==""&&(i="Espa\xF1ol_Ingles"),this._SpeechToSpeechService.GetListlanguage(i).subscribe(l=>{this._visibleLoading=!1,this._ItemLanguage=JSON.parse(l.body?.json??""),this._item=this._ItemLanguage.ListLanguageText[0],this.pageGoStart()},l=>{this.alertSmg("Error")})}loadMemory(){var t=this.getMemory("MemoryList");let e="",i=t.then(s=>{console.log("memoria"),console.log(s),s!=""&&(this._listMemory=JSON.parse(s)),this._cdRef.detectChanges()});e!=null&&e!=null&&e!="",console.log("memory load")}getMemory(t){return b(this,null,function*(){return this._utiliti.GetLocalStorage(t)})}savedMemory(t){return b(this,null,function*(){let e=new L,i=!0;var s=yield this.MemoryExist(t);s.name!=""&&s.name!=null&&(this.alertSmg("Ya existe"),i=!1),t!=null&&t!=""&&i&&(e.content=t,t.length>=20?e.name=t.substring(0,20)+"...":e.name=t.toUpperCase()+"...",e.id=Math.max(this._listMemory.length)+1,this._listMemory.push(e),console.log("Saved"),this.alertSmg("Guardado..."),console.log(this._listMemory),this.saveLocalStorage("MemoryList"))})}SelectionMemory(t){return b(this,null,function*(){var e=yield this.MemoryExist(t);e!=null&&e!=null&&e.name!=""?(console.log("Cargando:"+e.name),this._extractedText=e.content):console.log("error cargando"+e)})}deleteMemory(t){return b(this,null,function*(){var e=yield this.MemoryExist(t);if(e!=null&&e!=null&&e.name!=""){var i=this._listMemory.filter(s=>s.name!=e.name);this._listMemory=i,this.saveLocalStorage("MemoryList"),this.alertSmg("Eliminado..."),this.closeAlert()}else console.log("error cargando"+e),this.closeAlert()})}saveLocalStorage(t,e=""){e!=""?this._utiliti.SetLocalStorage(t,e):this._utiliti.SetLocalStorage(t,JSON.stringify(this._listMemory))}MemoryExist(t){var e=new L;return this._listMemory.forEach(i=>{i.name.toUpperCase().replace("...","")==t.toUpperCase().replace("...","")&&(console.log("Encontrado : "+JSON.stringify(i)),e=i)}),e}alertSmg(t){this.startTimer(3e3),this._msg=t,this._cdRef.detectChanges()}startTimer(t){this.stopTimer(this);var e=setTimeout(()=>{this.closeAlert()},t)}closeAlert(){this._msg="",this._cdRef.detectChanges()}stopTimer(t){t!==null&&t!=null&&clearTimeout(t)}};o.\u0275fac=function(e){return new(e||o)(h(v),h(q),h(j),h(U),h(V),h(B),h(Y),h(Q))},o.\u0275cmp=I({type:o,selectors:[["app-speech-to-speech"]],standalone:!0,features:[A],decls:24,vars:4,consts:[[1,"horizontal-container"],[1,"container-general-chat"],[1,"container-chat"],["class"," container-item-direction-user "],[1,"btn-go-page"],[1,"bi","bi-skip-backward-fill",3,"click"],[1,"bi","bi-skip-forward-fill",3,"click"],[1,"config-chat",2,"display","none"],["viewMenu",""],[1,"btn-menu",3,"click"],[1,"bi","bi-caret-down-fill"],[1,"item-label"],[1,"select-item","select",3,"click","change"],["class","btn-menu-close"],["class","text-recognition"],[1,"container-item-direction-user"],[1,"container-item","user"],[1,"logo-user"],[1,"language-bot","language"],[1,"item","text"],["id","menu"],[3,"click"],[1,"bi","bi-mic-fill"],[1,"bi","bi-mic-mute",3,"click"],[1,"bi","bi-0-circle"],[3,"value"],[1,"btn-menu-close",3,"click"],[1,"bi","bi-caret-up-fill"],[1,"text-recognition"]],template:function(e,i){if(e&1){let s=S();a(0,"div",0)(1,"div",1)(2,"div",2),C(3,re,13,6,"div",3),c(),a(4,"div",4)(5,"button")(6,"i",5),g("click",function(){return i.pageGo("-")}),c()(),C(7,se,2,0,"button"),a(8,"button")(9,"i",6),g("click",function(){return i.pageGo("+")}),c()()(),a(10,"div",7,8)(12,"button",9),g("click",function(){f(s);let m=y(11);return _(m.style.display="none")}),w(13,"i",10),c(),a(14,"div",11)(15,"label"),d(16,"Idioma"),c(),a(17,"select",12),g("click",function(m){return i.onSelectChange(m)})("change",function(m){return i.onSelectChange(m)}),a(18,"option"),d(19,"Seleccionar"),c(),G(20,ae,2,2,"option",25,ie),c()()(),C(22,ce,2,0,"button",13)(23,le,3,1,"div",14),c()()}if(e&2){let s=y(11);p(3),x(3,i._item.languageModeFrom!=""?3:-1),p(4),x(7,i._counPage>0?7:-1),p(13),F(i._listVoiceView),p(2),x(22,s.style.display=="none"?22:-1),p(1),x(23,i.isUserSpeaking?23:-1)}},dependencies:[H,z,J],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;text-align:center;text-shadow:0px -1px 1px white}.container-general-chat[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;overflow:hidden}.container-chat[_ngcontent-%COMP%]{padding:10px 10px 100px;height:100vh;width:80vw;justify-content:center;display:flex;flex-direction:column;row-gap:20px}@media (max-width: 368px){#container-text-to-speech[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-bottom:100px}}.container-item[_ngcontent-%COMP%]{background-color:navy;min-height:10px;padding:0 0 4px;border-radius:5px;color:#000;display:flex;flex-direction:row;width:auto;max-width:90%;min-width:80%;box-shadow:0 0 5px #000}.container-item-direction-user[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;justify-content:center}.user[_ngcontent-%COMP%]{background-color:#088700;display:flex;flex-direction:column;justify-content:end;position:relative}.container-item-direction-bot[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;justify-content:start}.bot[_ngcontent-%COMP%]{background-color:green;display:flex;flex-direction:column;justify-content:start;position:relative}#menu[_ngcontent-%COMP%]{width:100%;bottom:-5px;flex-direction:row-reverse;justify-items:end;align-content:end;background-color:none;position:relative;display:flex;flex-wrap:wrap;justify-content:flex-start;align-items:center;column-gap:15px}#menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0;right:0;padding:5px;border-radius:10px;background-color:#00f;border:none;color:#fff;height:38px;width:38px;box-shadow:0 0 5px #000,inset 0 0 5px #fff;cursor:pointer}.logo-user[_ngcontent-%COMP%]{top:-28px;right:-19px;background-color:#fff;padding:5px;border-radius:10px;position:absolute;color:#000;box-shadow:0 0 5px #000}.logo-bot[_ngcontent-%COMP%]{top:-20px;left:-20px;padding:5px;background-color:#fff;border-radius:10px;position:absolute;color:#000;box-shadow:0 0 5px #000}.config-chat[_ngcontent-%COMP%]{width:80vw;margin-right:100px;margin-left:100px;height:200px;border-radius:10px;background-color:#ff4500;box-shadow:0 0 5px 1px #000,0 0 2px #fff inset;position:relative;padding:10px}.btn-menu[_ngcontent-%COMP%]{position:absolute;top:0;right:0;background-color:#fff;height:40px;width:40px;padding:2px;border:none;border-radius:0 5px 0 20px;box-shadow:0 0 5px 1px #000,0 0 2px #fff inset;font-size:19px}.btn-menu-close[_ngcontent-%COMP%]{position:absolute;bottom:0;right:50px;background-color:#fff;height:40px;width:40px;padding:2px;border:none;border-radius:5px 5px 0 0;box-shadow:0 0 5px 1px #000,0 0 2px #fff inset;font-size:19px}.item-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:start}.select[_ngcontent-%COMP%]{background-color:#000;box-shadow:0 0 5px #fff inset;max-width:200px}.language[_ngcontent-%COMP%]{color:#000;margin-bottom:5px;padding:5px;box-shadow:0 0 5px #000 inset;border:1px solid transparent;border-radius:5px}.language-user[_ngcontent-%COMP%]{color:#6796f3}.language-bot[_ngcontent-%COMP%]{color:#bfffc8e3}.text[_ngcontent-%COMP%]{font-size:16px;margin:5px;color:#fff}.btn-go-page[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;position:sticky;bottom:40px}.btn-go-page[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:5px;padding:5px;background-color:green;width:auto;height:auto;display:flex;justify-content:center;align-items:center;font-size:20px;margin:5px}.btn-go-page[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0;padding:0;filter:drop-shadow(1px 1px 1px white)}.play[_ngcontent-%COMP%], .pause[_ngcontent-%COMP%]{background-color:#fff}.text-recognition[_ngcontent-%COMP%]{position:absolute;top:90px;border-radius:8px;box-shadow:0 0 5px #000;background-color:#fff;min-height:20px;width:auto;min-width:50px;font-size:18px;text-align:center}"]});let n=o;return n})();export{Me as SpeechToSpeechComponent};
