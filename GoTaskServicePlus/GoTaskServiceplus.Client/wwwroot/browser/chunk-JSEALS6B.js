import{b as p,c as d}from"./chunk-VYAYXPXE.js";import{a as v}from"./chunk-OMG2A7U2.js";import{d as g}from"./chunk-VLMSGL5J.js";import{Ca as h,oa as f,p as c,r as s,xa as m}from"./chunk-EYTT7SII.js";var L=(()=>{let n=class n{secretKey(){return"miClaveSecreta"}constructor(i,t,r,e,a,l,u){this._CommonService=i,this.http=t,this.route=r,this._util=l,this.Register=u,this.counter=0,this._configservice=a,this._route=r,this._login=e,this._http=t}ValidationLogin(i,t=!0){if(this.Register.ValidateUserActive(),t){try{var r=!1;if(i!="*"&&(r=this._configservice.ValidationLogin()),this.ActionKey(r),!r)return!1;var e=this._configservice.GetRols(),a=this.IsPublic(i);if(a)return!0;var l=this.IsAdmin(e);if(l)return!0;var u=this.IsVendor(e,i);if(u)return!0;var I=this.IsMarker(e,i);if(I)return!0;var R=this.IsCustomer(e,i);return R?!0:(this._CommonService._AlertService.Alert("Su rol actualmente no tiene autorizacion para esta funcci\xF3n"),this.RedirectPage(i),!1)}catch{this._configservice.DeleteBeareLogin(),this.route.navigate(["/login"])}return this.route.navigate(["/login"]),!1}return!0}ActionKey(i){i||(this._configservice.DeleteBeareLogin(),this.route.navigate(["/login"]))}IsAdmin(i){var t=!1,r=i.find(e=>e.isAdmin);return t=r!=null,t}IsPublic(i){return i=="*"}IsVendor(i,t){var r=i.filter(e=>e.isVendor&&e.permissionByRoll.page==t&&e.permissionByRoll.read);return r!=null&&r.length>0}IsMarker(i,t){var r=i.filter(e=>e.isMaker&&e.permissionByRoll.page==t&&e.permissionByRoll.read);return r!=null&&r.length>0}IsCustomer(i,t){var r=i.filter(e=>e.isCustomer&&e.permissionByRoll.page==t&&e.permissionByRoll.read);return r!=null&&r.length>0}RedirectPage(i){this.route.navigate(["/home-menu"])}alertMsg(i,t){this._util.alertMsg(this.languageTraslate(i),t)}languageTraslate(i){return i}};n.\u0275fac=function(t){return new(t||n)(s(p),s(f),s(m),s(g),s(h),s(v),s(d))},n.\u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();export{L as a};
