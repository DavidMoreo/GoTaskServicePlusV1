import{b as K,d as Q,f as W}from"./chunk-FWKZQHCM.js";import"./chunk-ISTIWSIF.js";import"./chunk-Q2UCRY37.js";import"./chunk-MVUZ45C4.js";import{a as X}from"./chunk-JSEALS6B.js";import"./chunk-VYAYXPXE.js";import"./chunk-OMG2A7U2.js";import"./chunk-VLMSGL5J.js";import{a as I}from"./chunk-DY7UBFIR.js";import"./chunk-MV2P2U5R.js";import{$ as N,A as m,B as C,C as O,Ca as T,E as h,H as S,I as b,J as V,K as k,L as A,M as a,N as o,O as g,P as f,Q as d,R as u,U as j,Va as q,X as r,Y as w,Z as D,aa as x,i as G,ia as $,ka as H,la as L,oa as R,p as F,r as B,s as E,ta as z,u as _,v as y,va as U,x as M,xa as J}from"./chunk-EYTT7SII.js";var Y=(()=>{let c=class c{constructor(e,i,t){this.http=e,this.host=i,this._listBuyGroupByIdBuy=new Array,this.isBuyProduct=!1,this.stausBuy="",this._movementType=new Q,this.buy=new K,this._host=i,this._http=e,this._loading=t}GetAllBuyStatus(e){let i=new L({"Content-Type":"application/json"});this.GetAllCartStorage();var t=this._listBuyStorageTemp,l=this._http.get(this._host.GetHostApi()+`BuyCustomer/GetAllBuyStatus?movementTypeItem=${e}&page=0`);return l.subscribe(p=>{this._listProduct=p.data,this.LoadGroup(),this._loading.Loading(!1)}),l}LoadGroup(){this._listBuyGroupByIdBuy=new Array,this._listProduct!=null&&this._listProduct.forEach(e=>{var i=this._listBuyGroupByIdBuy.find(t=>t==e.idBuy);(i==null||i==null)&&this._listBuyGroupByIdBuy.push(e.idBuy)})}Delete(e){let i=new L({"Content-Type":"application/json"});var t=this._http.delete(this._host.GetHostApi()+`BuyCustomer/DeleteAdminBuyCustomer?id=${e}`,{headers:i});return t.subscribe(l=>{this._loading.Loading(!1),l.status&&(this.GetAllBuyStatus(this.stausBuy),this._listProduct=this._listProduct.filter(p=>p.id!=e))}),t}ChangedStatusBuy(e,i){let t=new L({"Content-Type":"application/json"});var l=this._http.post(this._host.GetHostApi()+`BuyCustomer/CancelAdminBuyById?id=${e}&movementTypeItem=${i}`,{headers:t});return l.subscribe(p=>{this._listBuyGroupByIdBuy=new Array,p.status&&(this._listProduct=this._listProduct.filter(P=>P.id!=e),this.LoadGroup()),this._loading.Loading(!1)}),l}GetAllCartStorage(){var e=window.localStorage.getItem("BuyList");e!=null&&e!=null&&e!=""&&(this._listBuyStorage=JSON.parse(e)),this._listBuyStorage==null&&(this._listBuyStorage=new Array)}AddProductCart(e){var i=this.GetCartById(e);(i==null||i==null)&&(this._listBuyStorage.push(e),window.localStorage.setItem("BuyList",JSON.stringify(this._listBuyStorage)))}RemoveCartById(e){this.GetAllCartStorage(),this._listBuyStorage=this._listBuyStorage.filter(i=>i!=e),alert("Remove"),window.localStorage.setItem("BuyList",JSON.stringify(this._listBuyStorage))}GetCartById(e){this.GetAllCartStorage();var i=this._listBuyStorage.find(t=>t==e);return i}BuyProduct(e){this.isBuyProduct=!0}};c.\u0275fac=function(i){return new(i||c)(B(R),B(T),B(I))},c.\u0275prov=F({token:c,factory:c.\u0275fac,providedIn:"root"});let s=c;return s})();var se=(s,c)=>c.id,v=s=>({gray:s});function ae(s,c){if(s&1){let n=f();a(0,"div",16)(1,"div",17)(2,"p"),r(3),o()()(),a(4,"div",16)(5,"div",17)(6,"button",18),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.ChangedStatus(i.id,t._ListBuyService._movementType.purchaseGenerated))}),r(7,"1"),o(),r(8," Compra en validaci\xF3n "),o(),a(9,"div",17)(10,"button",18),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.ChangedStatus(i.id,t._ListBuyService._movementType.purchaseInProcess))}),r(11,"2"),o(),r(12," Compra en alistamiento "),o(),a(13,"div",17)(14,"button",18),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.ChangedStatus(i.id,t._ListBuyService._movementType.purchaseInDelivery))}),r(15,"3"),o(),r(16," Compra en reparto o lista para recogida "),o(),a(17,"div",17)(18,"button",18),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.ChangedStatus(i.id,t._ListBuyService._movementType.purchaseCompleted))}),r(19,"4"),o(),r(20," Compra en entregada "),o(),a(21,"div",17)(22,"button",19),r(23,"4"),o(),r(24," Compra cancelada por cliente "),o(),a(25,"div",17)(26,"button",19),r(27,"4"),o(),r(28," Compra cancelada por vendedor "),o(),a(29,"div",17)(30,"button",18),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.ChangedStatus(i.id,t._ListBuyService._movementType.purchaseCancelledByAdmin))}),r(31,"4"),o(),r(32," Compra cancelada por administrador "),o()()}if(s&2){let n=u().$implicit,e=u(3);m(1),h("ngClass",x(9,v,n.movementTypeItem!="Compra en verificaci\xF3n")),m(2),D(" Nombre : ",n.buyer.customer,""),m(2),h("ngClass",x(11,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseGenerated)),m(4),h("ngClass",x(13,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseInProcess)),m(4),h("ngClass",x(15,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseInDelivery)),m(4),h("ngClass",x(17,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseCompleted)),m(4),h("ngClass",x(19,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseCancelledByCustomer)),m(4),h("ngClass",x(21,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseCancelledByVendor)),m(4),h("ngClass",x(23,v,n.movementTypeItem!=e._ListBuyService._movementType.purchaseCancelledByAdmin))}}function ce(s,c){if(s&1){let n=f();a(0,"button",20),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.Delete(i.id))}),r(1,"Eliminar "),g(2,"i",21),o()}}function le(s,c){if(s&1){let n=f();a(0,"button",20),d("click",function(){_(n);let i=u().$implicit,t=u(3);return y(t.CancelBuy(i.id))}),r(1,"Cancelar "),g(2,"i",21),o()}}function ue(s,c){if(s&1){let n=f();a(0,"div",6)(1,"div",7)(2,"div",8),g(3,"img",9),o(),a(4,"p"),r(5),o()(),S(6,ae,33,25),a(7,"div",10)(8,"button",11),d("click",function(){let t=_(n).$implicit,l=u(3);return y(l.SetPhoneNumber(t))}),g(9,"i",12),o(),S(10,ce,3,0,"button",13)(11,le,3,0),a(12,"button",14),d("click",function(){let t=_(n).$implicit,l=u(3);return y(l.SelectedDetail(t.id))}),r(13,"Detalle "),g(14,"i",15),o()()()}if(s&2){let n=c.$implicit,e=u(3);m(3),j("src",e.GetUrlImg(n,"PHONE"),M),m(2),w(n.name),m(1),b(6,e.idBuySelectDetail==n.id?6:-1),m(4),b(10,n.movementTypeItem==e._ListBuyService._movementType.purchaseCancelledByAdmin||n.movementTypeItem==e._ListBuyService._movementType.purchaseCancelledByCustomer||n.movementTypeItem==e._ListBuyService._movementType.purchaseCancelledByVendor?10:11)}}function me(s,c){if(s&1&&(k(0,ue,15,4,"div",22,se),a(2,"p",5),r(3),o()),s&2){let n=c.$implicit,e=u(2);A(e.GetGroup(e._ListBuyService._listProduct,n)),m(3),w(e.GetGroupPrice(e._ListBuyService._listProduct,n))}}function de(s,c){if(s&1&&k(0,me,4,1,"p",23,V),s&2){let n=u();A(n._ListBuyService._listBuyGroupByIdBuy)}}function pe(s,c){s&1&&(a(0,"p",24),r(1,"No tienes compras realizadas"),o())}var Ie=(()=>{let c=class c{constructor(e,i,t,l,p,P,Z,ee,te){this.route=e,this._cdRef=te,this.type="all",this.page=0,this._listGuid=new Array,this.idBuySelectDetail="",this._param=t,this._titleService=i,this._ListBuyService=l,this._loading=p,this._BuyProduct=P,this._configservice=Z,this._Permission=ee}ngOnInit(){var e=this._Permission.ValidationLogin("admin-buy");e&&(this._titleService.setTitle("Mi carrito de compras"),this._ListBuyService.stausBuy="Compra en verificaci\xF3n",this.loadData())}loadData(){return G(this,null,function*(){this._loading.Loading(!0),this._ListBuyService.GetAllBuyStatus(this._ListBuyService.stausBuy)})}SelectedDetail(e){this.idBuySelectDetail=e,this._cdRef.detectChanges()}CancelBuy(e){this._ListBuyService.ChangedStatusBuy(e,this._ListBuyService._movementType.purchaseCancelledByAdmin)}ChangedStatus(e,i){alert(i),this._ListBuyService.ChangedStatusBuy(e,i)}Delete(e){this._ListBuyService.Delete(e)}GetNewStatus(e){this._ListBuyService.stausBuy=e,this._ListBuyService.GetAllBuyStatus(e)}GetUrlImg(e,i){var t=this._configservice.GetUrlImgBuy(e,i);return t}SetPhoneNumber(e){console.log(e);var i="https://api.whatsapp.com/send?phone=57"+e.buyer.mobileNumber+"&text=Me interesa este producto: "+e.name;window.open(i,"_blank")}GetGroup(e,i){return e.filter(t=>t.idBuy==i)}GetGroupPrice(e,i){var t=e.filter(p=>p.idBuy==i),l=0;return t.forEach(p=>{l+=p.salePrice*p.quantity}),this.converCurrency(l)}converCurrency(e){var t=Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(e);return t}};c.\u0275fac=function(i){return new(i||c)(C(J),C(z),C(U),C(Y),C(I),C(W),C(T),C(X),C(O))},c.\u0275cmp=E({type:c,selectors:[["app-admin-list-buy"]],standalone:!0,features:[N],decls:22,vars:2,consts:[[1,"menu-status"],[3,"click"],[1,"scroll"],[1,"container-prices-general"],[1,"product-container"],[1,"total"],[1,"item-buy"],[1,"header-item"],[1,"item-ico"],[1,"img-ico",3,"src"],[1,"btn-menu"],[1,"item-menu",3,"click"],[1,"bi","bi-whatsapp"],["class","btn-item-menu cancel"],[1,"btn-item-menu","delete",3,"click"],[1,"bi","bi-caret-down-fill"],[1,"detail-status"],[1,"status",3,"ngClass"],[1,"status-btn",3,"click"],[1,"status-btn"],[1,"btn-item-menu","cancel",3,"click"],[1,"bi","bi-x-circle"],["class","item-buy"],["class","total"],[1,"title"]],template:function(i,t){i&1&&(a(0,"h4"),r(1),o(),a(2,"div",0)(3,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseGenerated)}),r(4,"En validaci\xF3n"),o(),a(5,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseInProcess)}),r(6,"En alistamiento"),o(),a(7,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseInDelivery)}),r(8,"En reparto lista para recogida"),o(),a(9,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseCompleted)}),r(10," En entregada"),o(),a(11,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseCancelledByCustomer)}),r(12," Cancelada por cliente"),o(),a(13,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseCancelledByVendor)}),r(14," Cancelada por Vendedor"),o(),a(15,"button",1),d("click",function(){return t.GetNewStatus(t._ListBuyService._movementType.purchaseCancelledByAdmin)}),r(16," Compra cancelada por administrador"),o()(),a(17,"div",2)(18,"div",3)(19,"div",4),S(20,de,2,0)(21,pe,2,0),o()()()),i&2&&(m(1),w(t._ListBuyService.stausBuy),m(19),b(20,t._ListBuyService._listProduct!=null?20:21))},dependencies:[q,H,$],styles:[".item-buy[_ngcontent-%COMP%]{width:500px;background-color:#6db774;border-radius:5px;display:flex;justify-content:start;align-items:center;padding:5px;box-shadow:0 0 5px #000;font-size:12px;color:#fff}@media (max-width: 468px){.item-buy[_ngcontent-%COMP%]{width:90%}}.product-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:5px;overflow:auto;align-items:center;row-gap:20px}.delete[_ngcontent-%COMP%]{height:100%;width:50px;border-radius:5px;background-color:#ff7f7f;color:#fff}i[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px black)}.title[_ngcontent-%COMP%]{background-color:green;color:#fff;text-align:center;padding:5px;width:100%}.item-buy[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-direction:column}.item-ico[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.img-ico[_ngcontent-%COMP%]{height:35px;width:auto;min-width:45px;border-radius:5px;box-shadow:0 0 5px #000}.header-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;background-color:#00f;border-radius:5px;box-shadow:0 0 5px #000}.header-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;font-size:10px;width:90%}.btn-menu[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:center;column-gap:10px;margin-top:10px;width:100%}.btn-item-menu[_ngcontent-%COMP%]{width:100px;border:none;box-shadow:0 0 5px #000,0 0 5px #000 inset;border-radius:0 0 5px 5px;color:#fff}.cancel[_ngcontent-%COMP%]{background-color:red}.delete[_ngcontent-%COMP%]{background-color:green}.detail-status[_ngcontent-%COMP%]{width:95%;border:1px solid gray;border-radius:5px;margin-top:10px;margin-bottom:10px;justify-content:start;align-items:start;padding:5px;flex-direction:column;row-gap:10px;display:flex}.status[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;column-gap:10px}.status-btn[_ngcontent-%COMP%]{border-radius:100%;width:20px;height:20px;border:none;box-shadow:0 0 5px #000;background-color:green;border:1px solid white;color:#fff}.gray[_ngcontent-%COMP%]{filter:grayscale(100%)}.menu-status[_ngcontent-%COMP%]{display:flex;background-color:#696969;column-gap:5px;overflow:auto;margin-top:40px}.menu-status[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:5px;width:auto}.total[_ngcontent-%COMP%]{background-color:green;width:100%;font-size:20px;text-align:end;color:#fff;padding:3px 20PX 3px 3px;box-shadow:0 0 5px #000}.gps[_ngcontent-%COMP%]{border-radius:5px;border:none;box-shadow:0 0 5px #000,inset 0 0 5px #000;padding:3px;width:40px;height:40px}"]});let s=c;return s})();export{Ie as AdminListBuyComponet};
