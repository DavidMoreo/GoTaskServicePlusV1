import{a as J,b as O,c as v,d as H}from"./chunk-IFDYJBL7.js";import{a as A}from"./chunk-OMG2A7U2.js";import"./chunk-VLMSGL5J.js";import{a as z,b as $}from"./chunk-DY7UBFIR.js";import"./chunk-MV2P2U5R.js";import{$ as j,A as d,B as u,C as P,Ca as I,E as T,H as M,I as C,K as V,L as k,M as o,N as s,Na as R,O as h,P as y,Pa as D,Q as p,Qa as N,R as m,Sa as B,Ta as G,Va as U,W as S,X as _,Y as L,Z as b,i as w,s as E,ta as F,u as g,v as f}from"./chunk-EYTT7SII.js";var q=(c,r)=>r.id;function Y(c,r){if(c&1&&(o(0,"option",19),_(1),s()),c&2){let l=r.$implicit;T("value",l.name),d(1),L(l.name)}}function Z(c,r){if(c&1){let l=y();o(0,"button",10)(1,"i",20),p("click",function(){g(l);let e=m(),i=S(14);return f(e.speech(i.value))}),s()()}}function K(c,r){if(c&1){let l=y();o(0,"button",21),p("click",function(){g(l);let e=m(),i=S(14);return f(e.speechGoPage(i.value,"min"))}),h(1,"i",22),s(),o(2,"button",10)(3,"i",23),p("click",function(){g(l);let e=m();return f(e.speechCancel())}),s()(),o(4,"button",21),p("click",function(){g(l);let e=m(),i=S(14);return f(e.speechGoPage(i.value,"max"))}),h(5,"i",24),s()}}function Q(c,r){if(c&1&&(o(0,"div",17)(1,"div",25)(2,"p"),_(3),s()(),o(4,"p",26),_(5),s()()),c&2){let l=m();d(3),b(" ",l.pages,""),d(2),b(" ",l.texSpeech," ")}}function W(c,r){if(c&1){let l=y();o(0,"div",28)(1,"div",29),p("click",function(){let i=g(l).$implicit,n=m(2);return f(n.SelectionMemory(i.name))}),o(2,"p"),_(3),s()(),o(4,"button",30),p("click",function(){let i=g(l).$implicit,n=m(2);return f(n.deleteMemory(i.name))}),h(5,"i",31),s()()}if(c&2){let l=r.$implicit;d(3),b(" ",l.name," ")}}function X(c,r){if(c&1&&(o(0,"div",27),V(1,W,6,1,"div",32,q),s()),c&2){let l=m();d(1),k(l._listMemory)}}var de=(()=>{let r=class r{constructor(t,e,i,n,x,a){this.loading=a,this._visibleBtn=!0,this._speechStop=!1,this._msg="",this._listVoiceView=new Array,this._selectedVoice=null,this.statusSpeech=!1,this.countSpeech=0,this._listMemory=Array(),this._visibleLoading=!1,this._configservice=t,this._baseApi=this._configservice.GetHostApi(),this.file=e,this._cdRef=i,this._titleService=n,this._utiliti=x}ngAfterViewInit(){this.LoadDataAfterView()}ngOnInit(){this.loadngOnInit()}loadngOnInit(){this._utiliti.SetTitle("Hola",this);var t=new J;t.language="Espa\xF1ol",t.value="en-US",this.loadMemory()}LoadDataAfterView(){let t=window.speechSynthesis;t.onvoiceschanged=()=>{this._listVoice=window.speechSynthesis.getVoices(),this._listVoice.forEach(e=>{if(e.localService){let i=new v;i.name=e.name,i.id=this._listVoiceView.length+1,this._listVoiceView.push(i),console.log(e.name)}})}}modeSpeechLang(t){(this._listVoice==null||this._listVoice.length>0)&&this.LoadDataAfterView(),this._listVoiceView=new Array;let e=new v;this._listVoice.forEach(i=>{e=new v,t.target.value=="todos"?(e.name=i.name,e.id=this._listVoiceView.length+1,this._listVoiceView.push(e)):i.localService&&this._listVoiceView.push(e)}),this._cdRef.detectChanges(),this.alertSmg("realizado")}onSelectChange(t){this._listVoice.forEach(e=>{e.name==t.target.value&&(this._selectedVoice=e,console.log(this._selectedVoice))})}speech(t){if(this.statusSpeech=!0,t!=""&&t!=null)try{this.statusSpeech=!1;let n=this.getReplace(t).split(/\. (?=[A-Z])|\.$|\.\n/);this.texSpeech=n[this.countSpeech];var e=new SpeechSynthesisUtterance;e.text=this.texSpeech,e.volume=1,e.rate=.6,e.pitch=.7,this._selectedVoice!=null&&(console.log("Voz activa"),e.voice=this._selectedVoice),this.pages=this.countSpeech+" de "+n.length,e.onend=()=>{this.countSpeech<n.length?(console.log("ejecuto : "+n[this.countSpeech]+" Conteo "+this.countSpeech+" de "+n.length),this.countSpeech=this.countSpeech+1,this.speech(t)):this.countSpeech>=n.length&&(this.countSpeech=0,console.log("Cancelada : "+n[this.countSpeech]+" > "+this.countSpeech),this.statusSpeech=!1,this.speechCancel()),console.log("Terminado : "+e)},(e.text=="undefined"||e.text==null)&&(e.text="Lectura finalizada"),speechSynthesis.speak(e),e.onresume=()=>{console.log("onresume :   "+this.countSpeech+"  "+n.length)},e.onerror=()=>{console.log("error :   "+this.countSpeech+"  "+n.length)},e.onboundary=()=>{console.log("fin :   "+this.countSpeech+"  "+n.length)},(speechSynthesis.speaking||speechSynthesis.pending)&&(this.pages=this.countSpeech+" de "+n.length,this.statusSpeech=!0,this._visibleBtn=!1)}catch(i){console.log("Error : "+i),this.alertSmg("No se puede continuar"),this.statusSpeech=!1}this._cdRef.detectChanges()}getReplace(t){let e=t.replace("/","");return e=e.replace("#",""),e=e.replace("\u2013",""),e=e.replace("_",""),e}speechCancel(){window.speechSynthesis.cancel(),window.speechSynthesis.speaking&&this.speechCancel(),this.statusSpeech=!1,this._visibleBtn=!0}speechGoPage(t,e){window.speechSynthesis.cancel(),e=="min"&&(this.countSpeech=this.countSpeech-1),e=="max"&&(this.countSpeech=this.countSpeech+1),this.alertSmg("pagina "+this.countSpeech),this.speech(t)}onFileSelected(t){console.log("File..."),this._visibleLoading=!0;let e=t.target.files[0];console.log("File...Load"),e&&(this.loading.Loading(!0),this.extractTextFromPDF(e))}extractTextFromPDF(t){this.alertSmg("Esperando..."),this.file.ReaderFile(t).subscribe({next:e=>{this._visibleLoading=!1,this._extractedText=e.json,console.log("File...fin"+this._extractedText),this.countSpeech=0,this.loading.Loading(!1),this._cdRef.detectChanges()}})}inputTextChanged(){this._extractedTextChanged=this._extractedText}loadMemory(){var t=this.getMemory("MemoryList");console.log("memori Back"),console.log(t);let e="",i=t.then(n=>{console.log("memoria"),console.log(n),n!=""&&(this._listMemory=JSON.parse(n))});e!=null&&e!=null&&e!="",console.log("memory load"),this._cdRef.detectChanges()}getMemory(t){return w(this,null,function*(){return this._utiliti.GetLocalStorage("MemoryList")})}savedMemory(t){return w(this,null,function*(){let e=new O,i=!0;var n=yield this.MemoryExist(t);n.name!=""&&n.name!=null&&(this.alertSmg("Ya existe"),i=!1),t!=null&&t!=""&&i&&(e.content=t,t.length>=20?e.name=t.substring(0,20)+"...":e.name=t.toUpperCase()+"...",e.id=Math.max(this._listMemory.length)+1,this._listMemory.push(e),console.log("Saved"),this.alertSmg("Guardado..."),console.log(this._listMemory),this.saveLocalStorage("MemoryList"))})}SelectionMemory(t){return w(this,null,function*(){var e=yield this.MemoryExist(t);e!=null&&e!=null&&e.name!=""?(console.log("Cargando:"+e.name),this._extractedText=e.content):console.log("error cargando"+e)})}deleteMemory(t){return w(this,null,function*(){var e=yield this.MemoryExist(t);if(e!=null&&e!=null&&e.name!=""){var i=this._listMemory.filter(n=>n.name!=e.name);this._listMemory=i,this.saveLocalStorage("MemoryList"),this.alertSmg("Eliminado..."),this.closeAlert()}else console.log("error cargando"+e),this.closeAlert()})}saveLocalStorage(t){this._utiliti.SetLocalStorage(t,JSON.stringify(this._listMemory))}MemoryExist(t){var e=new O;return this._listMemory.forEach(i=>{i.name.toUpperCase().replace("...","")==t.toUpperCase().replace("...","")&&(console.log("Encontrado : "+JSON.stringify(i)),e=i)}),e}Clean(){this._visibleLoading=!0,this._extractedText="",this.countSpeech=0,this._visibleLoading=!1,this._cdRef.detectChanges()}alertSmg(t){this.startTimer(3e3),this._msg=t,this._cdRef.detectChanges()}startTimer(t){this.stopTimer(this);var e=setTimeout(()=>{this.closeAlert()},t)}closeAlert(){this._msg="",this._cdRef.detectChanges()}stopTimer(t){t!==null&&t!=null&&clearTimeout(t)}};r.\u0275fac=function(e){return new(e||r)(u(I),u(H),u(P),u(F),u(A),u(z))},r.\u0275cmp=E({type:r,selectors:[["app-text-to-speech"]],standalone:!0,features:[j],decls:32,vars:5,consts:[[1,"conatiner-speechText"],["id","container-text-to-speech"],[1,"select-item",3,"change"],["value","local"],["value","todos"],[1,"select-item",3,"click","change"],["id","text-input","placeholder","Escribe el texto que deseas convertir a voz...",3,"ngModel","ngModelChange"],["texValue",""],[1,"coniner-flex"],["class","btn"],[1,"btn"],[1,"bi","bi-eraser",3,"click"],[1,"bi","bi-floppy2-fill",3,"click"],[1,"custom-file-upload"],["for","fileInput",1,"file-button"],[1,"bi","bi-filetype-pdf","btn"],["type","file","id","fileInput","accept",".pdf",2,"display","none",3,"change"],["id","container-text-speech"],["class","list-memory"],[3,"value"],[1,"bi","bi-play-fill",3,"click"],[1,"btn",3,"click"],[1,"bi","bi-skip-backward-fill"],[1,"bi","bi-stop-fill",3,"click"],[1,"bi","bi-skip-forward-fill"],[1,"container-pages"],[1,"text-speech"],[1,"list-memory"],[1,"item-memory"],[3,"click"],[1,"delete-memory",3,"click"],[1,"bi","bi-trash-fill"],["class","item-memory"]],template:function(e,i){if(e&1){let n=y();h(0,"app-common-loading"),o(1,"div",0)(2,"div",1)(3,"select",2),p("change",function(a){return i.modeSpeechLang(a)}),o(4,"option",3),_(5,"Idioma local"),s(),o(6,"option",4),_(7,"Todos"),s()(),o(8,"select",5),p("click",function(a){return i.onSelectChange(a)})("change",function(a){return i.onSelectChange(a)}),o(9,"option"),_(10,"Seleccionar"),s(),V(11,Y,2,2,"option",19,q),s(),o(13,"textarea",6,7),p("ngModelChange",function(a){return i._extractedText=a}),s(),h(15,"br"),o(16,"div",8),M(17,Z,2,0,"button",9)(18,K,6,0),o(19,"button",10)(20,"i",11),p("click",function(){return i.Clean()}),s()(),o(21,"button",10)(22,"i",12),p("click",function(){g(n);let a=S(14);return f(i.savedMemory(a.value))}),s()(),o(23,"div",13)(24,"label",14),h(25,"i",15),s(),o(26,"input",16),p("change",function(a){return i.onFileSelected(a)}),s()(),h(27,"div"),s(),o(28,"div"),h(29,"div"),s()(),M(30,Q,6,2,"div",17)(31,X,3,0,"div",18),s()}if(e&2){let n=S(14);d(11),k(i._listVoiceView),d(2),T("ngModel",i._extractedText),d(4),C(17,i._visibleBtn&&n.value!=""?17:-1),d(1),C(18,i._visibleBtn==!1?18:-1),d(12),C(30,i.texSpeech!=null&&i.texSpeech!=""&&i.statusSpeech?30:-1),d(1),C(31,i._listMemory!=null&&i._listMemory.length>0&&i.statusSpeech==!1?31:-1)}},dependencies:[U,B,G,R,D,N,$],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;text-align:center;text-shadow:0px -1px 1px white}#container-text-to-speech[_ngcontent-%COMP%]{max-width:600px;min-width:40%;margin:25px auto 0;padding:20px;border-radius:5px;box-shadow:0 0 5px}@media (max-width: 368px){#container-text-to-speech[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-bottom:100px}}.coniner-flex[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}@media (max-width: 368px){.coniner-flex[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}}textarea[_ngcontent-%COMP%]{width:100%;height:250px;border-radius:5px;resize:none}button[_ngcontent-%COMP%]{margin:10px;padding:10px 20px;font-size:46px;border-radius:100%;background-color:#000;color:#fff;text-shadow:0px -1px 8px gray;box-shadow:0 0 10px #fff inset}.btn[_ngcontent-%COMP%]{margin:10px;padding:10px 20px;font-size:26px;border-radius:100%;background-color:#000;color:#fff;text-shadow:0px -1px 8px gray;box-shadow:0 0 10px #fff inset;border:none}@media (max-width: 368px){.btn[_ngcontent-%COMP%]{font-size:28px}}.title[_ngcontent-%COMP%]{text-align:center;text-shadow:-1px 0px 1px white;font-size:22px}@media (max-width: 368px){.title[_ngcontent-%COMP%]{font-size:18px}}.conatiner-speechText[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-content:center;column-gap:10px;padding-bottom:50px}@media (max-width: 600px){.conatiner-speechText[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}}.custom-file-upload[_ngcontent-%COMP%]{width:89px;margin:0;display:flex;justify-content:center;align-items:center}.list-memory[_ngcontent-%COMP%]{padding-top:50px;padding-bottom:10px;row-gap:10px;display:flex;justify-content:start;flex-direction:column;align-items:start;width:400px;overflow:auto;max-height:400px;padding-left:2px}@media (max-width: 600px){.list-memory[_ngcontent-%COMP%]{justify-content:start;align-items:center;width:100vw}}.item-memory[_ngcontent-%COMP%]{background-color:#ffb395;border-radius:5px;width:250px;min-height:30px;max-height:30px;box-shadow:0 0 5px #000;flex-direction:column;overflow:hidden;flex-wrap:nowrap;position:relative;padding:4px;color:#000;font-weight:700;cursor:pointer;display:flex;justify-content:center}.item-memor[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:100%;overflow:hidden;color:#fff;text-shadow:0px -1px 1px black}.delete-memory[_ngcontent-%COMP%]{height:8px;width:48px;position:absolute;background-color:transparent;box-shadow:0 0;left:auto;right:-15px;top:-21px;font-size:15px;border:none}.delete-memory[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background-color:gray;width:25px;height:25px;box-shadow:0 0 5px #000;display:flex;flex-direction:column;overflow:hidden;flex-wrap:nowrap;position:relative;background-color:#cd5c5c;align-items:center;justify-content:center;border-radius:0 0 0 5px}.select-item[_ngcontent-%COMP%]{border-radius:5px;background-color:#000;color:#fff;box-shadow:0 0 5px #fff,0 0 5px 1px #fff inset;font-size:14px;width:50%;margin-bottom:10px;padding:5px}#container-text-speech[_ngcontent-%COMP%]{margin:35px 0 0;background-color:#ffb497;box-shadow:0 0 5px #000;max-height:auto;max-height:500px;width:100%;border-radius:5px;overflow-x:hidden;overflow-y:auto}@media (max-width: 500px){#container-text-speech[_ngcontent-%COMP%]{width:90%}}.text-speech[_ngcontent-%COMP%]{text-align:justify;font-size:28px;margin:10px}.container-pages[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-width:100%;background-color:#ff4500;padding:5px;border-radius:5px;box-shadow:0 0 5px #000}.container-pages[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;text-align:center;font-weight:700;width:auto;margin:0;padding:8px;border-radius:5px;background-color:#fff;box-shadow:0 0 5px #000}"]});let c=r;return c})();export{de as TextToSpeechComponent};
